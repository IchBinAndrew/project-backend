from sklearn.feature_extraction.text import TfidfVectorizer
from sklearn.ensemble import RandomForestClassifier
from sklearn.metrics import accuracy_score
from sklearn.model_selection import train_test_split
import numpy as np
from natasha import MorphVocab, Doc, Segmenter, NewsEmbedding, NewsMorphTagger
from natasha import NamesExtractor, DatesExtractor, AddrExtractor, MoneyExtractor
import random

segmenter = Segmenter()
embedding = NewsEmbedding()
morph_tagger = NewsMorphTagger(embedding)
morph_vocab = MorphVocab()

def get_synonyms(word):
    # Здесь можно использовать готовый словарь или API синонимов
    # Для примера — небольшой словарь
    synonyms_dict = {
        "прекрасный": ["отличный", "замечательный", "чудесный"],
        "хороший": ["нормальный", "приемлемый", "удовлетворительный"],
        "ужас": ["отвратительный", "ужасающий", "плохой"],
        "доволен": ["рад", "удовлетворён", "счастлив"],
        "медленный": ["тормозной", "неторопливый", "ленивый"],
        # добавляй свои слова
    }
    return synonyms_dict.get(word.lower(), [])

def synonym_augmentation(text, n=1):
    doc = Doc(text)
    doc.segment(segmenter)
    doc.tag_morph(morph_tagger)

    tokens = []
    for token in doc.tokens:
        synonyms = get_synonyms(token.text)
        if synonyms and random.random() < 0.3:  # с вероятностью 30% заменяем слово
            replacement = random.choice(synonyms)
            tokens.append(replacement)
        else:
            tokens.append(token.text)
    return " ".join(tokens)
augmented_data = []
for example in data:
    for _ in range(2):  # 2 варианта на один пример
        new_text = synonym_augmentation(example["text"])
        augmented_data.append({"text": new_text, "label": example["label"]})
data = [
    {"text": "Прекрасный телефон. Камера, конечно, как у микроволновки, но зато корпус блестит.", "label": 3},
    {"text": "Очень доволен покупкой! Всё работает отлично.", "label": 0},
    {"text": "Это просто ужас. Батарея не держит, греется сильно.", "label": 2},
    {"text": "Нормально, свои деньги оправдывает.", "label": 1},
    {"text": "О, какая замечательная производительность… в 2007 году, наверное.", "label": 3},
    {"text": "Купил и не пожалел. Всё быстро и удобно.", "label": 0},
    {"text": "Ну да, работает. Как и мой утюг.", "label": 3},
    {"text": "Телефон ни о чём. Зарядка медленная, экран тусклый.", "label": 2},
    {"text": "Средний аппарат. Не лучше и не хуже других.", "label": 1},
    {"text": "Просто бомба! Камера топ", "label": 0},
    {"text": "Смартфон превзошёл все ожидания!", "label": 0},
    {"text": "Отличный звук и автономность.", "label": 0},
    {"text": "Быстрая доставка, идеальная комплектация.", "label": 0},
    {"text": "Пользуюсь с удовольствием, никаких проблем.", "label": 0},
    {"text": "Хороший дисплей, удобный интерфейс.", "label": 0},
    {"text": "Очень лёгкий и компактный, идеально в руке лежит.", "label": 0},
    {"text": "Зарядки хватает на два дня, шикарно!", "label": 0},
    {"text": "Удивлён качеством за такую цену!", "label": 0},
    {"text": "Все нужные функции есть, всё летает.", "label": 0},
    {"text": "Эталон бюджетного смартфона.", "label": 0},
    {"text": "Телефон как телефон. Работает.", "label": 1},
    {"text": "Пока всё стабильно, без особенностей.", "label": 1},
    {"text": "Дизайн простой, функционал стандартный.", "label": 1},
    {"text": "Работает, как и ожидал.", "label": 1},
    {"text": "Всё на среднем уровне.", "label": 1},
    {"text": "Не хуже и не лучше конкурентов.", "label": 1},
    {"text": "Всё ожидаемо, никаких сюрпризов.", "label": 1},
    {"text": "Простой рабочий вариант.", "label": 1},
    {"text": "Экран обычный, звук средний.", "label": 1},
    {"text": "Тестирую пока, впечатлений нет.", "label": 1},
    {"text": "Разряжается за полдня, это кошмар.", "label": 2},
    {"text": "Глючит постоянно, особенно при звонках.", "label": 2},
    {"text": "Экран тусклый, углы обзора плохие.", "label": 2},
    {"text": "Больше никогда не куплю эту марку.", "label": 2},
    {"text": "Медленно открывает даже настройки.", "label": 2},
    {"text": "Звук тихий, слышно еле-еле.", "label": 2},
    {"text": "Пластик дешевый, скрипит в руках.", "label": 2},
    {"text": "Сломался через 2 недели — обидно.", "label": 2},
    {"text": "Камера снимает хуже, чем старая Nokia.", "label": 2},
    {"text": "Всё зависает, как будто внутри картошка.", "label": 2},
    {"text": "Настолько быстрый, что включается только по праздникам.", "label": 3},
    {"text": "Дизайн шикарный… если вам нравится кирпич.", "label": 3},
    {"text": "Звук объёмный — особенно когда трещит корпус.", "label": 3},
    {"text": "Приложения запускаются быстрее, чем я старею… но только в снах.", "label": 3},
    {"text": "Супер-функция: угадывает, когда не надо работать.", "label": 3},
    {"text": "Камера такая, что распознаёт лица… но только инопланетян.", "label": 3},
    {"text": "Автономность впечатляет: включаешь — и уже ищешь розетку.", "label": 3},
    {"text": "Может использоваться как обогреватель в холодное время.", "label": 3},
    {"text": "Очень продвинутый телефон — думает сам, нужно ли тебе интернет.", "label": 3},
    {"text": "Удивительная функция — каждый раз включается с разным результатом.", "label": 3},
    {"text": "Очень понравился экран — яркий и чёткий.", "label": 0},
    {"text": "Звук классный, приятно слушать музыку.", "label": 0},
    {"text": "Доволен покупкой, ни разу не пожалел.", "label": 0},
    {"text": "Шустрый, лёгкий, автономность хорошая.", "label": 0},
    {"text": "Прекрасно справляется с задачами.", "label": 0},
    {"text": "Цена и качество — супер.", "label": 0},
    {"text": "Все функции работают без нареканий.", "label": 0},
    {"text": "Камера радует детализацией.", "label": 0},
    {"text": "Нравится дизайн, выглядит стильно.", "label": 0},
    {"text": "Очень удобный в использовании.", "label": 0},
    {"text": "Мощный процессор, игры идут отлично.", "label": 0},
    {"text": "Быстро подключается к Wi-Fi и Bluetooth.", "label": 0},
    {"text": "Работает лучше, чем ожидал.", "label": 0},
    {"text": "Не хуже других в этом ценовом сегменте.", "label": 1},
    {"text": "Работает нормально, без восторга.", "label": 1},
    {"text": "Заряжается средне, как у всех.", "label": 1},
    {"text": "Стандартный интерфейс, ничего нового.", "label": 1},
    {"text": "Собран неплохо, но без изысков.", "label": 1},
    {"text": "Вполне приемлемо для повседневных задач.", "label": 1},
    {"text": "Тестирую второй день, пока всё типично.", "label": 1},
    {"text": "Сравним с другими моделями по функционалу.", "label": 1},
    {"text": "Ничего особенно хорошего или плохого.", "label": 1},
    {"text": "Заявленные характеристики соответствуют.", "label": 1},
    {"text": "Всё стабильно, как ожидал.", "label": 1},
    {"text": "Без лишнего шума, но и без вау-эффекта.", "label": 1},
    {"text": "Нормальный рабочий вариант.", "label": 1},
    {"text": "Разочарован. Камера ужасная.", "label": 2},
    {"text": "Подвисает даже при наборе SMS.", "label": 2},
    {"text": "Батарея садится за пару часов.", "label": 2},
    {"text": "Хуже телефона у меня ещё не было.", "label": 2},
    {"text": "Плохая чувствительность сенсора.", "label": 2},
    {"text": "Качество сборки отвратительное.", "label": 2},
    {"text": "Периодически сам перезагружается.", "label": 2},
    {"text": "При звонке хрипит динамик.", "label": 2},
    {"text": "Не стоит своих денег.", "label": 2},
    {"text": "Через неделю перестал включаться.", "label": 2},
    {"text": "Сильно тормозит даже при простых действиях.", "label": 2},
    {"text": "Слетает связь и не ловит интернет.", "label": 2},
    {"text": "Экран выгорает через месяц.", "label": 2},
    {"text": "Камера просто сказка… если вы любите сюрпризы.", "label": 3},
    {"text": "Заряд держит — пока не включишь экран.", "label": 3},
    {"text": "Лучшее, что он делает — лежит на полке.", "label": 3},
    {"text": "Настолько мощный, что тормозит из скромности.", "label": 3},
    {"text": "Экран такой яркий, что я ничего не вижу.", "label": 3},
    {"text": "Реагирует на касания… иногда.", "label": 3},
    {"text": "Телефон с характером — сам решает, когда работать.", "label": 3},
    {"text": "Фотографии получаются… абстрактные.", "label": 3},
    {"text": "В комплекте всё: зарядка, провод и разочарование.", "label": 3},
    {"text": "Не тормозит — просто обдумывает действия.", "label": 3},
    {"text": "Автономность отличная — если вы не пользуетесь им.", "label": 3},
    {"text": "Технология будущего: не работает и не мешает.", "label": 3},
]
data+=augmented_data

texts = [d["text"] for d in data]
labels = [d["label"] for d in data]

X_train, X_val, y_train, y_val = train_test_split(texts, labels, test_size=0.2, random_state=42)

vectorizer = TfidfVectorizer(ngram_range=(1, 2), max_features=600)
X_train_tfidf = vectorizer.fit_transform(X_train)
X_val_tfidf = vectorizer.transform(X_val)
from sklearn.linear_model import LogisticRegression

clf = LogisticRegression(max_iter=1000)
clf.fit(X_train_tfidf, y_train)
y_pred = clf.predict(X_val_tfidf)
